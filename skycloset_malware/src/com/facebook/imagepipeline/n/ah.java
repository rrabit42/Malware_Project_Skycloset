package com.facebook.imagepipeline.n;

import a.f;
import a.h;
import android.net.Uri;
import com.facebook.b.a.d;
import com.facebook.common.d.f;
import com.facebook.common.g.a;
import com.facebook.common.g.h;
import com.facebook.imagepipeline.d.e;
import com.facebook.imagepipeline.d.f;
import com.facebook.imagepipeline.j.d;
import com.facebook.imagepipeline.o.b;
import java.util.Map;
import java.util.concurrent.atomic.AtomicBoolean;

public class ah extends Object implements ak<d> {
  private final e a;
  
  private final f b;
  
  private final h c;
  
  private final a d;
  
  private final ak<d> e;
  
  public ah(e parame, f paramf, h paramh, a parama, ak<d> paramak) {
    this.a = parame;
    this.b = paramf;
    this.c = paramh;
    this.d = parama;
    this.e = paramak;
  }
  
  private f<d, Void> a(k<d> paramk, al paramal, d paramd) {
    String str = paramal.b();
    return new Object(this, paramal.c(), str, paramk, paramal, paramd);
  }
  
  private static Uri a(b paramb) { return paramb.b().buildUpon().appendQueryParameter("fresco_partial", "true").build(); }
  
  static Map<String, String> a(an paraman, String paramString, boolean paramBoolean, int paramInt) { return !paraman.b(paramString) ? null : (paramBoolean ? f.a("cached_value_found", String.valueOf(paramBoolean), "encodedImageSize", String.valueOf(paramInt)) : f.a("cached_value_found", String.valueOf(paramBoolean))); }
  
  private void a(k<d> paramk, al paramal, d paramd, d paramd1) {
    a a1 = new a(paramk, this.a, paramd, this.c, this.d, paramd1, null);
    this.e.a(a1, paramal);
  }
  
  private void a(AtomicBoolean paramAtomicBoolean, al paramal) { paramal.a(new Object(this, paramAtomicBoolean)); }
  
  private static boolean b(h<?> paramh) { return (paramh.c() || (paramh.d() && paramh.f() instanceof java.util.concurrent.CancellationException)); }
  
  public void a(k<d> paramk, al paramal) {
    b b1 = paramal.a();
    if (!b1.n()) {
      this.e.a(paramk, paramal);
      return;
    } 
    paramal.c().a(paramal.b(), "PartialDiskCacheProducer");
    Uri uri = a(b1);
    d d1 = this.b.a(b1, uri, paramal.d());
    AtomicBoolean atomicBoolean = new AtomicBoolean(false);
    this.a.a(d1, atomicBoolean).a(a(paramk, paramal, d1));
    a(atomicBoolean, paramal);
  }
}
