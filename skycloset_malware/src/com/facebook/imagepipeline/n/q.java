package com.facebook.imagepipeline.n;

import com.facebook.common.d.i;
import com.facebook.common.e.a;
import com.facebook.g.b;
import com.facebook.imagepipeline.e.e;
import com.facebook.imagepipeline.j.d;
import com.facebook.imagepipeline.o.b;

public class q {
  static int a(float paramFloat) {
    if (paramFloat > 0.6666667F)
      return 1; 
    byte b;
    for (b = 2;; b++) {
      double d1 = b;
      double d2 = 1.0D / (Math.pow(d1, 2.0D) - d1);
      if (1.0D / d1 + d2 * 0.3333333432674408D <= paramFloat)
        return b - 1; 
    } 
  }
  
  public static int a(b paramb, d paramd) {
    int i;
    if (!d.c(paramd))
      return 1; 
    float f = b(paramb, paramd);
    if (paramd.e() == b.a) {
      i = b(f);
    } else {
      i = a(f);
    } 
    int j = Math.max(paramd.i(), paramd.h());
    e e = paramb.f();
    if (e != null) {
      f = e.c;
    } else {
      f = 2048.0F;
    } 
    while ((j / i) > f) {
      if (paramd.e() == b.a) {
        i *= 2;
        continue;
      } 
      i++;
    } 
    return i;
  }
  
  static float b(b paramb, d paramd) {
    int j;
    i.a(d.c(paramd));
    e e = paramb.f();
    if (e == null || e.b <= 0 || e.a <= 0 || paramd.h() == 0 || paramd.i() == 0)
      return 1.0F; 
    int i = c(paramb, paramd);
    if (i == 90 || i == 270) {
      j = 1;
    } else {
      j = 0;
    } 
    if (j) {
      i = paramd.i();
    } else {
      i = paramd.h();
    } 
    if (j) {
      j = paramd.h();
    } else {
      j = paramd.i();
    } 
    float f1 = e.a / i;
    float f2 = e.b / j;
    float f3 = Math.max(f1, f2);
    a.a("DownsampleUtil", "Downsample - Specified size: %dx%d, image size: %dx%d ratio: %.1f x %.1f, ratio: %.3f for %s", new Object[] { Integer.valueOf(e.a), Integer.valueOf(e.b), Integer.valueOf(i), Integer.valueOf(j), Float.valueOf(f1), Float.valueOf(f2), Float.valueOf(f3), paramb.b().toString() });
    return f3;
  }
  
  static int b(float paramFloat) {
    if (paramFloat > 0.6666667F)
      return 1; 
    for (byte b = 2;; b = b1) {
      byte b1 = b * 2;
      double d = 1.0D / b1;
      if (d + 0.3333333432674408D * d <= paramFloat)
        return b; 
    } 
  }
  
  private static int c(b paramb, d paramd) {
    boolean bool2 = paramb.g().d();
    boolean bool1 = false;
    if (!bool2)
      return 0; 
    int i = paramd.f();
    if (i == 0 || i == 90 || i == 180 || i == 270)
      bool1 = true; 
    i.a(bool1);
    return i;
  }
}
