package com.facebook.common.i;

import android.annotation.SuppressLint;
import android.os.Build;
import android.os.Environment;
import android.os.StatFs;
import android.os.SystemClock;
import com.facebook.common.d.n;
import java.io.File;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public class a {
  private static a a;
  
  private static final long b = TimeUnit.MINUTES.toMillis(2L);
  
  private long g;
  
  private final Lock h = new ReentrantLock();
  
  private StatFs a(StatFs paramStatFs, File paramFile) {
    if (paramFile != null) {
      if (!paramFile.exists())
        return null; 
      if (paramStatFs == null)
        try {
          return a(paramFile.getAbsolutePath());
        } catch (IllegalArgumentException paramStatFs) {
          return null;
        } catch (Throwable paramStatFs) {
          throw n.b(paramStatFs);
        }  
      paramStatFs.restat(paramFile.getAbsolutePath());
      return paramStatFs;
    } 
    return null;
  }
  
  protected static StatFs a(String paramString) { return new StatFs(paramString); }
  
  public static a a() { // Byte code:
    //   0: ldc com/facebook/common/i/a
    //   2: monitorenter
    //   3: getstatic com/facebook/common/i/a.a : Lcom/facebook/common/i/a;
    //   6: ifnonnull -> 19
    //   9: new com/facebook/common/i/a
    //   12: dup
    //   13: invokespecial <init> : ()V
    //   16: putstatic com/facebook/common/i/a.a : Lcom/facebook/common/i/a;
    //   19: getstatic com/facebook/common/i/a.a : Lcom/facebook/common/i/a;
    //   22: astore_0
    //   23: ldc com/facebook/common/i/a
    //   25: monitorexit
    //   26: aload_0
    //   27: areturn
    //   28: astore_0
    //   29: ldc com/facebook/common/i/a
    //   31: monitorexit
    //   32: aload_0
    //   33: athrow
    // Exception table:
    //   from	to	target	type
    //   3	19	28	finally
    //   19	23	28	finally }
  
  private void b() {
    if (!this.i) {
      this.h.lock();
      try {
        if (!this.i) {
          this.d = Environment.getDataDirectory();
          this.f = Environment.getExternalStorageDirectory();
          d();
          this.i = true;
        } 
        return;
      } finally {
        this.h.unlock();
      } 
    } 
  }
  
  private void c() {
    if (this.h.tryLock())
      try {
        if (SystemClock.uptimeMillis() - this.g > b)
          d(); 
        return;
      } finally {
        this.h.unlock();
      }  
  }
  
  private void d() {
    this.c = a(this.c, this.d);
    this.e = a(this.e, this.f);
    this.g = SystemClock.uptimeMillis();
  }
  
  @SuppressLint({"DeprecatedMethod"})
  public long a(a parama) {
    StatFs statFs;
    b();
    c();
    if (parama == a.a) {
      statFs = this.c;
    } else {
      statFs = this.e;
    } 
    if (statFs != null) {
      long l2;
      long l1;
      if (Build.VERSION.SDK_INT >= 18) {
        l1 = statFs.getBlockSizeLong();
        l2 = statFs.getAvailableBlocksLong();
      } else {
        l1 = statFs.getBlockSize();
        l2 = statFs.getAvailableBlocks();
      } 
      return l1 * l2;
    } 
    return 0L;
  }
  
  public boolean a(a parama, long paramLong) {
    b();
    long l = a(parama);
    boolean bool = true;
    if (l > 0L) {
      if (l < paramLong)
        return true; 
      bool = false;
    } 
    return bool;
  }
}
