package com.google.android.gms.common.api.internal;

import android.util.Log;
import com.google.android.gms.common.api.Status;
import com.google.android.gms.common.api.f;
import com.google.android.gms.common.api.g;
import com.google.android.gms.common.api.h;
import com.google.android.gms.common.api.k;
import com.google.android.gms.common.api.l;
import com.google.android.gms.common.api.m;
import com.google.android.gms.common.api.n;
import com.google.android.gms.common.api.o;
import com.google.android.gms.common.internal.af;
import java.lang.ref.WeakReference;

public final class am<R extends k> extends o<R> implements l<R> {
  private n<? super R, ? extends k> a;
  
  private am<? extends k> b;
  
  private g<R> d;
  
  private final Object e;
  
  private Status f;
  
  private final WeakReference<f> g;
  
  private final ao h;
  
  private boolean i;
  
  private final void a() {
    if (this.a == null && this.c == null)
      return; 
    f f1 = (f)this.g.get();
    if (!this.i && this.a != null && f1 != null) {
      f1.a(this);
      this.i = true;
    } 
    Status status = this.f;
    if (status != null) {
      b(status);
      return;
    } 
    g g1 = this.d;
    if (g1 != null)
      g1.a(this); 
  }
  
  private final void a(Status paramStatus) {
    synchronized (this.e) {
      this.f = paramStatus;
      b(this.f);
      return;
    } 
  }
  
  private final void b(Status paramStatus) {
    synchronized (this.e) {
      if (this.a != null) {
        paramStatus = this.a.a(paramStatus);
        af.a(paramStatus, "onFailure must not return null");
        this.b.a(paramStatus);
      } else if (b()) {
        this.c.a(paramStatus);
      } 
      return;
    } 
  }
  
  private static void b(k paramk) {
    if (paramk instanceof h)
      try {
        ((h)paramk).a();
        return;
      } catch (RuntimeException runtimeException) {
        String str;
        StringBuilder stringBuilder = new StringBuilder((str = String.valueOf(paramk)).valueOf(str).length() + 18);
        stringBuilder.append("Unable to release ");
        stringBuilder.append(str);
        Log.w("TransformedResultImpl", stringBuilder.toString(), runtimeException);
      }  
  }
  
  private final boolean b() {
    f f1 = (f)this.g.get();
    return (this.c != null && f1 != null);
  }
  
  public final void a(g<?> paramg) {
    synchronized (this.e) {
      this.d = paramg;
      a();
      return;
    } 
  }
  
  public final void a(R paramR) {
    synchronized (this.e) {
      if (paramR.a().d()) {
        if (this.a != null) {
          ac.a().submit(new an(this, paramR));
        } else if (b()) {
          this.c.b(paramR);
        } 
      } else {
        a(paramR.a());
        b(paramR);
      } 
      return;
    } 
  }
}
